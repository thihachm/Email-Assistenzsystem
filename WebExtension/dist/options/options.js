"use strict";!function(e){const t=document.querySelector("#de .areaRules"),n=document.querySelector("#en .areaRules"),a=document.querySelector("#newRule .areaPattern"),r=document.querySelector("#newRule .areaLanguage"),c=document.querySelector("#newRule .areaExample"),l=document.querySelector("#btNewRule"),d=document.querySelector("#clr"),o=document.querySelector("#reset"),s=document.querySelector("#calendarName");function i(e,t){const n=document.createElement("div"),a=document.createElement("span"),r=document.createElement("input");function c(t,n){let c=t?.target?.value||n;new RegExp("^"+e.pattern+"$").test(c)?(a.classList.add("matches"),r.classList.add("matches")):(a.classList.remove("matches"),r.classList.remove("matches"))}return r.setAttribute("type","text"),n.className="form-group",r.className="form-field",a.innerText="pattern"==t?"Pattern":"Example",r.value="pattern"==t?e.pattern:e.example,"example"==t&&(r.addEventListener("input",c),r.addEventListener("focus",c),c(null,e.example)),n.appendChild(a),n.appendChild(r),n}async function u(){const{calendarName:e}=await browser.storage.local.get("calendarName").then((e=>e)),a=document.querySelector("#calendarName input[type='text']");a.value=e||"",a.placeholder="Calendar Name";const{db:r}=await browser.storage.local.get("db").then((e=>e));if(r){const{de:e,en:a}=r;for(const n in e)if(Object.hasOwnProperty.call(e,n)){const a=e[n],r=document.createElement("div");r.className="rulerow";const c=document.createElement("input");c.setAttribute("type","checkbox"),c.checked=a.enabled,c.value="de."+n,r.appendChild(c);let l=i(a,"pattern");r.appendChild(l),l=i(a,"example"),r.appendChild(l),t.appendChild(r)}for(const e in a)if(Object.hasOwnProperty.call(a,e)){const t=a[e],r=document.createElement("div");r.className="rulerow";const c=document.createElement("input");c.setAttribute("type","checkbox"),c.checked=t.enabled,c.value="en."+e,r.appendChild(c);let l=i(t,"pattern");r.appendChild(l),l=i(t,"example"),r.appendChild(l),n.appendChild(r)}}}async function p(){!async function(){t.innerHTML="",n.innerHTML=""}(),await u()}!async function(){s.appendChild(function(e){const t=document.createElement("div"),n=document.createElement("span"),a=document.createElement("input");return a.setAttribute("type","text"),t.className="form-group",a.className="form-field",n.innerText="Name",t.appendChild(n),t.appendChild(a),t}()),s.appendChild(function(e,t){const n=document.createElement("button");n.className="browser-style",n.innerText="Save";for(const e in t)if(Object.hasOwnProperty.call(t,e)){const a=t[e];n.style[e]=a}return n}(0,{height:"28px",width:"100px"})),function(){let e=document.createElement("div");e.className="rulerow";let t=i({pattern:""},"pattern");e.appendChild(t),a.appendChild(e),e=document.createElement("div");const n=document.createElement("div");n.className="form-group";const l=document.createElement("input"),d=document.createElement("span");l.setAttribute("type","text"),l.className="form-field",d.innerText="Test",l.placeholder="New Pattern",n.appendChild(d),n.appendChild(l),e.appendChild(n),c.appendChild(e),e=document.createElement("div");const o=document.createElement("input"),s=document.createElement("label");o.id="langDE",o.type="radio",o.name="lang",o.value="de",s.htmlFor="langDE",s.innerText="DE";const u=document.createElement("input"),p=document.createElement("label");u.id="langEN",u.type="radio",u.name="lang",u.value="en",p.htmlFor="langEN",p.innerText="EN",e.appendChild(o),e.appendChild(s),e.appendChild(u),e.appendChild(p),r.appendChild(e)}(),await u(),d.addEventListener("click",(async e=>{e.preventDefault(),await browser.runtime.sendMessage({command:"clearKnowledgebase",reciever:"OptionsAgent",sender:"DisplayAgent"}),await p()})),o.addEventListener("click",(async e=>{e.preventDefault(),await browser.runtime.sendMessage({command:"resetKnowledgebase",reciever:"OptionsAgent",sender:"DisplayAgent"}),await p()})),l.addEventListener("click",(async e=>{e.preventDefault();const t=document.querySelector("#newRule .areaPattern input"),n=t?.value;if(!n)return;const a=document.querySelector('#newRule .areaLanguage input[name="lang"]:checked'),r=a?.value;if(!r)return;const c=document.querySelector("#newRule .areaExample input"),l=c?.value;if(!l)return;const d={pattern:n,language:r,example:l};await browser.runtime.sendMessage({command:"addNewRule",reciever:"OptionsAgent",sender:"DisplayAgent",data:d}),await p()})),document.querySelector("#calendarName button").addEventListener("click",(async e=>{e.preventDefault();const t=document.querySelector("#calendarName input[type='text']");""!=t?.value&&(await browser.runtime.sendMessage({command:"set",reciever:"OptionsAgent",sender:"OptionsPanel",data:{key:"calendarName",value:t?.value}}),await browser.runtime.sendMessage({command:"attemptCreateCalendar",reciever:"OutputAgent",sender:"OptionsPanel",data:{name:t?.value}}))})),document.querySelectorAll(".rules input[type='checkbox']").forEach((e=>{e.addEventListener("click",(async e=>{await browser.runtime.sendMessage({command:"toggleRule",reciever:"OptionsAgent",sender:"OptionsPage",data:{path:e.target.value,enabled:e.target.checked}})}))}))}()}();